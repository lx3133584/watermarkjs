!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.watermark=n():t.watermark=n()}(window,function(){return r={},u.m=e=[function(t,n,e){t.exports=e(1).default},function(t,n,e){"use strict";e.r(n),e.d(n,"default",function(){return T});var r={};e.r(r),e.d(r,"atPos",function(){return s}),e.d(r,"lowerRight",function(){return p}),e.d(r,"upperRight",function(){return g}),e.d(r,"lowerLeft",function(){return v}),e.d(r,"upperLeft",function(){return y}),e.d(r,"center",function(){return w});var u={};function i(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,r)}return e}function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function c(t,n,e){var r;return r=e,f(t,n).then(function(t){return console.log(r,r._canvasRef),r._canvasRef.style.width=t.width+"px",r._canvasRef.style.height=t.height+"px",r._canvasRef.width=t.width,r._canvasRef.height=t.height,t.path})}function f(r,u){return new Promise(function(e,t){wx.getImageInfo({src:r,success:function(t){var n=function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?i(Object(e),!0).forEach(function(t){o(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}({},t,{path:r});"function"==typeof u&&u(n),e(n)},fail:t})})}function a(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.r(u),e.d(u,"atPos",function(){return b}),e.d(u,"lowerRight",function(){return m}),e.d(u,"lowerLeft",function(){return x}),e.d(u,"upperRight",function(){return O}),e.d(u,"upperLeft",function(){return j}),e.d(u,"center",function(){return P});var l=function(){function r(){var t,n,e;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,r),e=null,(n="canvas")in(t=this)?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}var t,n,e;return t=r,(n=[{key:"init",value:function(u){var i=this;return new Promise(function(e,r){wx.createSelectorQuery().select("#"+u).fields({node:!0,size:!0}).exec(function(t){var n=t[0].node;console.log(111111,u,n._canvasId,t),n?(i.canvas=n,i.release(n),e(n)):r("can not find canvas")})})}},{key:"get",value:function(){return this.canvas}},{key:"dataUrl",value:function(e,t){var r=t.type,u=t.quality;t.id;return new Promise(function(n,t){wx.canvasToTempFilePath({fileType:r,quality:u,x:0,y:0,width:e.width,height:e.height,destWidth:e.width,destHeight:e.height,canvasId:e._canvasId,success:function(t){console.log(111,t),n(t.tempFilePath)},fail:t})})}},{key:"release",value:function(t){t.getContext("2d").clearRect(0,0,t.width,t.height)}}])&&a(t.prototype,n),e&&a(t,e),r}();var h=/^data:([^;]+);base64,(.*)$/;var d=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return function(t){return n.reduce(function(t,n){return n.call(null,t)},t)}}(function(t){return h.exec(t).slice(1)},function(t){return[(n=t[1],window.atob(n)),t[0]];var n},function(t){return new Blob([function(t){for(var n=t.length,e=new Uint8Array(n),r=0;r<n;r++)e[r]=t.charCodeAt(r);return e}(t[0])],{type:t[1]})});function s(r,u,i){return i=i||1,function(t,n){var e=t.getContext("2d");return e.globalAlpha=i,e.drawImage(n.path,r(t,n),u(t,n)),t}}function p(t){return s(function(t,n){return t.width-(n.width+10)},function(t,n){return t.height-(n.height+10)},t)}function g(t){return s(function(t,n){return t.width-(n.width+10)},function(t,n){return 10},t)}function v(t){return s(function(t,n){return 10},function(t,n){return t.height-(n.height+10)},t)}function y(t){return s(function(t,n){return 10},function(t,n){return 10},t)}function w(t){return s(function(t,n){return(t.width-n.width)/2},function(t,n){return(t.height-n.height)/2},t)}function b(r,u,i,o,c,f){return f=f||1,function(t){var n=t.getContext("2d");n.globalAlpha=f,n.fillStyle=c,n.font=o;var e=n.measureText(i);return n.fillText(i,r(t,e,n),u(t,e,n)),t}}function m(t,n,e,r,u){return b(function(t,n){return t.width-(n.width+10)},function(t){return u||t.height-10},t,n,e,r)}function x(t,n,e,r,u){return b(function(){return 10},function(t){return u||t.height-10},t,n,e,r)}function O(t,n,e,r,u){return b(function(t,n){return t.width-(n.width+10)},function(){return u||20},t,n,e,r)}function j(t,n,e,r,u){return b(function(){return 10},function(){return u||20},t,n,e,r)}function P(t,n,e,r,u){return b(function(t,n,e){return e.textAlign="center",t.width/2},function(t,n,e){return e.textBaseline="middle",t.height/2},t,n,e,r)}var _=u;function k(n,e){return Object.keys(e).forEach(function(t){return n[t]=e[t]}),n}var R,S={init:function(){},type:"png",quality:1,id:"watermark"};function I(t){return k(k({},S),t)}function T(u){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=I(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});return R=R||new l,r||(r=R.init(i.id).then(function(){return c(u,i.init,R.get())})).then(function(t){return n=t,e=R.get(),r=e.getContext("2d"),(u=e.createImage()).src=n,new Promise(function(t,n){u.onload=function(){r.drawImage(u,0,0),t(e)},u.onerror=n});var n,e,r,u}),{draw:function(e){var t=this.then(function(){return t=e,n=R.get(),t.apply(null,[n]),n;var t,n});return T(u,i,t)},blob:function(t){var n=this.draw(t).then(d);return T(u,i,n)},image:function(t,e){var r=this,n=this.then(function(){return f(t)}).then(function(n){return r.draw(function(t){return e(t,n)})});return T(u,i,n)},text:function(t){var n=this.draw(t);return T(u,i,n)},then:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return r.then.apply(r,n)},exec:function(t){var n=0<arguments.length&&void 0!==t?t:function(t){return t};return this.then(function(){return R.dataUrl(R.get(),{type:i.type,quality:i.quality,id:i.id})}).then(n)}}}T.image=r,T.text=_,T.destroy=function(){return R.release()}}],u.c=r,u.d=function(t,n,e){u.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},u.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(n,t){if(1&t&&(n=u(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(u.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var r in n)u.d(e,r,function(t){return n[t]}.bind(null,r));return e},u.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return u.d(n,"a",n),n},u.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},u.p="",u(u.s=0);function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}var e,r});
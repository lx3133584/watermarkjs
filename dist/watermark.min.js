!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.watermark=n():t.watermark=n()}(window,function(){return r={},i.m=e=[function(t,n,e){t.exports=e(1).default},function(t,n,e){"use strict";e.r(n),e.d(n,"default",function(){return I});var r={};e.r(r),e.d(r,"atPos",function(){return g}),e.d(r,"lowerRight",function(){return p}),e.d(r,"upperRight",function(){return v}),e.d(r,"lowerLeft",function(){return y}),e.d(r,"upperLeft",function(){return w}),e.d(r,"center",function(){return b});var i={};function u(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,r)}return e}function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function c(t,n,e){var r;return r=e,f(t,n).then(function(t){return r._canvasRef.style.width=t.width+"px",r._canvasRef.style.height=t.height+"px",r._canvasRef.width=t.width,r._canvasRef.height=t.height,t.path})}function f(r,i){return new Promise(function(e,t){wx.getImageInfo({src:r,success:function(t){var n=function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?u(Object(e),!0).forEach(function(t){o(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}({},t,{path:r});"function"==typeof i&&i(n),e(n)},fail:t})})}function a(t,e,n,r,i,u){var o=2<arguments.length&&void 0!==n?n:0,c=3<arguments.length&&void 0!==r?r:0,f=4<arguments.length?i:void 0,a=5<arguments.length?u:void 0,l=e.getContext("2d"),h=e.createImage();return h.src=t,new Promise(function(t,n){h.onload=function(){f&&a?l.drawImage(h,o,c,f,a):l.drawImage(h,o,c),t(e)},h.onerror=n})}function l(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.r(i),e.d(i,"atPos",function(){return m}),e.d(i,"lowerRight",function(){return x}),e.d(i,"lowerLeft",function(){return O}),e.d(i,"upperRight",function(){return j}),e.d(i,"upperLeft",function(){return P}),e.d(i,"center",function(){return R});var h=function(){function r(){var t,n,e;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,r),e=null,(n="canvas")in(t=this)?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}var t,n,e;return t=r,(n=[{key:"init",value:function(t){var i=this;return new Promise(function(e,r){wx.createSelectorQuery().select("#"+t).fields({node:!0,size:!0}).exec(function(t){var n=t[0].node;n?(n._canvasRef.style.display="none",i.canvas=n,i.release(n),e(n)):r("can not find canvas")})})}},{key:"get",value:function(){return this.canvas}},{key:"dataUrl",value:function(r,t){var i=t.type,u=t.quality,o=t.id;return new Promise(function(n,t){var e=wx.getSystemInfoSync().pixelRatio;wx.canvasToTempFilePath({fileType:i,quality:u,x:0,y:0,width:r.width,height:r.height,destWidth:r.width*e,destHeight:r.height*e,canvasId:o,canvas:r,success:function(t){n(t.tempFilePath)},fail:t})})}},{key:"release",value:function(t){t.getContext("2d").clearRect(0,0,t.width,t.height)}}])&&l(t.prototype,n),e&&l(t,e),r}();var d=/^data:([^;]+);base64,(.*)$/;var s=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return function(t){return n.reduce(function(t,n){return n.call(null,t)},t)}}(function(t){return d.exec(t).slice(1)},function(t){return[(n=t[1],window.atob(n)),t[0]];var n},function(t){return new Blob([function(t){for(var n=t.length,e=new Uint8Array(n),r=0;r<n;r++)e[r]=t.charCodeAt(r);return e}(t[0])],{type:t[1]})});function g(t,r,i,u,o,n){return n=n||1,function(e){return e.getContext("2d").globalAlpha=n,f(t).then(function(t){var n={height:i||t.height,width:r||t.width};return a(t.path,e,u(e,n),o(e,n),r,i)})}}function p(t,n,e,r,i){return g(t,n,e,function(t,n){return t.width-(n.width+10)},function(t,n){return t.height-i-n.height||t.height-(n.height+10)},r)}function v(t,n,e,r,i){return g(t,n,e,function(t,n){return t.width-(n.width+10)},function(t,n){return i||10},r)}function y(t,n,e,r,i){return g(t,n,e,function(t,n){return 10},function(t,n){return t.height-i-n.height||t.height-(n.height+10)},r)}function w(t,n,e,r,i){return g(t,n,e,function(t,n){return 10},function(t,n){return i||10},r)}function b(t,n,e,r){return g(t,n,e,function(t,n){return(t.width-n.width)/2},function(t,n){return(t.height-n.height)/2},r)}function m(r,i,u,o,c,f){return f=f||1,function(t){var n=t.getContext("2d");n.globalAlpha=f,n.fillStyle=c,n.font=o;var e=n.measureText(u);return n.fillText(u,r(t,e,n),i(t,e,n)),t}}function x(t,n,e,r,i){return m(function(t,n){return t.width-(n.width+10)},function(t){return t.height-i||t.height-10},t,n,e,r)}function O(t,n,e,r,i){return m(function(){return 10},function(t){return t.height-i||t.height-10},t,n,e,r)}function j(t,n,e,r,i){return m(function(t,n){return t.width-(n.width+10)},function(){return i||20},t,n,e,r)}function P(t,n,e,r,i){return m(function(){return 10},function(){return i||20},t,n,e,r)}function R(t,n,e,r){return m(function(t,n,e){return e.textAlign="center",t.width/2},function(t,n,e){return e.textBaseline="middle",t.height/2},t,n,e,r)}var S=i;function _(n,e){return Object.keys(e).forEach(function(t){return n[t]=e[t]}),n}var k,T={init:function(){},type:"png",quality:1,id:"watermark"};function A(t){return _(_({},T),t)}function I(r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,u=A(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});return k=k||new h,i=i||k.init(u.id).then(function(){return c(r,u.init,k.get())}).then(function(t){return a(t,k.get())}),{draw:function(e){var t=this.then(function(){return t=e,n=k.get(),t.apply(null,[n]);var t,n});return I(r,u,t)},blob:function(t){var n=this.draw(t).then(s);return I(r,u,n)},image:function(t){var n=this.draw(t);return I(r,u,n)},text:function(t){var n=this.draw(t);return I(r,u,n)},then:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return i.then.apply(i,n)},exec:function(t){var n=0<arguments.length&&void 0!==t?t:function(t){return t};return i.then(function(){return k.dataUrl(k.get(),{type:u.type,quality:u.quality,id:u.id})}).then(n)}}}I.image=r,I.text=S,I.destroy=function(){return k.release()}}],i.c=r,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(n,t){if(1&t&&(n=i(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var r in n)i.d(e,r,function(t){return n[t]}.bind(null,r));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=0);function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}var e,r});